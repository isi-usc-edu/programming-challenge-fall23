<!DOCTYPE html>
<html data-wf-page="5ec5d9f8586ce5f443ae5667" data-wf-site="5ec5d86528da2f24250d634c" data-wf-status="1">
    <head>
        {% load static %}
        <meta charset="utf-8" />
		<title>Home â€¢ Programming Challenge</title>
		<meta content="Jobs is a full-featured Webflow Template to help you launch your own Job Portal. It features all pages required, including Jobs, Companies, Resume Submit, Pricing, Job Post, and much more!" name="description" />
		<meta content="Home 2 - Jobs - Webflow HTML Website Template" property="og:title" />
		<meta content="Jobs is a full-featured Webflow Template to help you launch your own Job Portal. It features all pages required, including Jobs, Companies, Resume Submit, Pricing, Job Post, and much more!" property="og:description" />
		<meta content="https://assets.website-files.com/5ec5d86528da2f24250d634c/5ecf37d29d8fbe6917deb769_jobs-featured-image.png" property="og:image" />
		<meta content="Home 2 - Jobs - Webflow HTML Website Template" property="twitter:title" />
		<meta content="Jobs is a full-featured Webflow Template to help you launch your own Job Portal. It features all pages required, including Jobs, Companies, Resume Submit, Pricing, Job Post, and much more!" property="twitter:description" />
		<meta content="https://assets.website-files.com/5ec5d86528da2f24250d634c/5ecf37d29d8fbe6917deb769_jobs-featured-image.png" property="twitter:image" />
		<meta property="og:type" content="website" />
		<meta content="summary_large_image" name="twitter:card" />
		<meta content="width=device-width, initial-scale=1" name="viewport" />
		<meta content="Webflow" name="generator" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
		<link href="https://assets.website-files.com/5ec5d86528da2f24250d634c/css/jobstemplate.webflow.f21da52cd.css" rel="stylesheet" type="text/css" />
        <link href="../static/images/favicon.png" rel="shortcut icon" type="image/x-icon"/>
		<link href="../static/images/favicon.png" rel="apple-touch-icon"/>
        <link rel="stylesheet" type="text/css" href="{% static "css/style.css" %}"> 
        <style>
            .item {
                object-fit: contain;
            }

            .addToCart {
                padding: 10px 15px;
                border-radius: 10px;
                margin-bottom: 0px;
                background-color: #755E48;
                box-shadow: 0 2px 6px 0 rgba(5, 21, 46, 0.12), 0 14px 14px 0 rgba(21, 60, 245, 0.2);
                -webkit-transition: box-shadow 300ms ease, background-color 300ms ease, -webkit-transform 300ms ease;
                transition: box-shadow 300ms ease, background-color 300ms ease, -webkit-transform 300ms ease;
                transition: transform 300ms ease, box-shadow 300ms ease, background-color 300ms ease;
                transition: transform 300ms ease, box-shadow 300ms ease, background-color 300ms ease, -webkit-transform 300ms ease;
                color: #fff;
                font-size: 16px;
                line-height: 18px;
                font-weight: 700;
                text-align: center;
                letter-spacing: 0.08em;
                text-transform: uppercase;
            }
        </style>
    </head>
    <body>
        <div data-node-type="commerce-cart-wrapper" data-open-product="" data-wf-page-link-href-prefix="" class="w-commerce-commercecartwrapper cart">
            <div data-node-type="commerce-cart-container-wrapper" style="display:none" class="w-commerce-commercecartcontainerwrapper w-commerce-commercecartcontainerwrapper--cartType-modal cart-wrapper">
                <div data-node-type="commerce-cart-container" role="dialog" class="w-commerce-commercecartcontainer">
                    <div class="w-commerce-commercecartheader">
                        <h4 class="w-commerce-commercecartheading text-center">Awaiting request confirmation ...</h4>
                    </div>
                    <div class="w-commerce-commercecartformwrapper">
                        <div class="w-commerce-commercecartemptystate empty-state-cart">
                            <img src="https://digitalsynopsis.com/wp-content/uploads/2016/06/loading-animations-preloader-gifs-ui-ux-effects-18.gif" height="128">
                            <div class="cart-empty-text">Please wait while we process your request! Do not refresh or reload this page.</div>
                        </div>
                        <div aria-live="" style="display:none" data-node-type="commerce-cart-error" class="w-commerce-commercecarterrorstate error-message">
                            <div class="w-cart-error-msg" data-w-cart-quantity-error="There&#x27;s been an error with your cart." data-w-cart-general-error="Something went wrong when adding this item to the cart." data-w-cart-checkout-error="Checkout is disabled on this site." data-w-cart-cart_order_min-error="The order minimum was not met. Add more items to your cart to continue." data-w-cart-subscription_error-error="Before you purchase, please use your email invite to verify your address so we can send order updates.">There&#x27;s been an error with your cart.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="page-wrapper">
            <div data-collapse="medium" data-animation="default" data-duration="400" data-w-id="58db7844-5919-d71b-dd74-2323ed8dffe9" data-easing="ease" data-easing2="ease" role="banner" class="header w-nav">
                <div class="container-default container-header w-container">
                    <a href="/" class="brand w-nav-brand">
                        <img src="{% static "images/favicon.png" %}" style="height: 48px; width: auto;" alt="Logo" class="header-logo" />
                    </a>
                    <div role="navigation" class="nav-menu-container w-nav-menu">
                        <div class="spacer header-mobile"></div>
                        <div class="nav-menu">
                            <ul role="list" class="header-navigation">
                                <li class="nav-item-wrapper">
                                    <a href="/" class="nav-link" style="color: black !important; font-weight: normal;">Home</a>
                                </li>
                                <li class="nav-item-wrapper">
                                    <a href="/#shop" class="nav-link" style="color: black !important; font-weight: normal;">Shop</a>
                                </li>
                                <li class="nav-item-wrapper">
                                    <a href="/cart" class="nav-link" style="color: black !important; font-weight: normal;">Cart</a>
                                </li>
                            </ul>
                        </div>
                        <div class="_2-buttons-header">
                            <span id="welcomeText"><a href="/login" class="button-primary button-header-primary w-button">Login</a></span>
                        </div>
                    </div>
                    <div data-w-id="58db7844-5919-d71b-dd74-2323ed8dfffb" class="menu-button w-nav-button">
                        <div data-is-ix2-target="1" class="menu-lottie-icon" data-w-id="9a64e014-3850-efda-23a3-56fba6ba1020" data-animation-type="lottie" data-src="https://assets.website-files.com/5ec5d86528da2f24250d634c/5ec5f8bbe2d02e5ece239ae7_lottieflow-menu-nav-07-05152E-easey.json" data-loop="0" data-direction="1" data-autoplay="0" data-renderer="svg" data-default-duration="2.4791666666666665" data-duration="0" data-ix2-initial-state="0"></div>
                    </div>
                    <div data-node-type="commerce-cart-wrapper" data-open-product="" data-wf-page-link-href-prefix="" class="w-commerce-commercecartwrapper cart">
                        <a href="/cart" data-node-type="commerce-cart-open-link" class="w-commerce-commercecartopenlink cart-buttno w-inline-block" role="button" aria-haspopup="dialog" aria-label="Open cart">
                            <img src="https://assets.website-files.com/5ec5d86528da2f24250d634c/5eec15d591e2b4025565dc34_shopping-bag-side%201.svg" alt="Bag - Jobs Webflow Template" />
                            <div data-wf-bindings="%5B%7B%22innerHTML%22%3A%7B%22type%22%3A%22Number%22%2C%22filter%22%3A%7B%22type%22%3A%22numberPrecision%22%2C%22params%22%3A%5B%220%22%2C%22numberPrecision%22%5D%7D%2C%22dataPath%22%3A%22database.commerceOrder.userItemsCount%22%7D%7D%5D" class="w-commerce-commercecartopenlinkcount cart-quantity">0</div>
                        </a>
                    </div>
                </div>
            </div>
            <div id="main">
                <div id="app"></div>
            </div>
        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="{% static "frontend/main.js" %}"></script>
    <script src="{% static "frontend/index.js" %}" type="text/javascript"></script>
    <script>
        function setCookie(name,value,days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days*24*60*60*1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + (value || "")  + expires + "; path=/";
        }

        function performSearch() {
            var $rows = $('.productsList');
            $('#searchProduct').keyup(function() {
                var val = $.trim($(this).val()).replace(/ +/g, ' ').toLowerCase();
            
                $rows.show().filter(function() {
                    var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
                    return !~text.indexOf(val);
                }).hide();
            });
        }

        function performVoiceSearch(inputValue) {
            var $rows = $('.productsList');
            var val = $.trim(inputValue).replace(/ +/g, ' ').toLowerCase();
            
            $rows.show().filter(function() {
                var text = $(this).text().replace(/\s+/g, ' ').toLowerCase();
                return !~text.indexOf(val);
            }).hide();
        }

        function addProductToCart(productID) {
            $.ajax({
                type: 'GET',
                url: 'http://127.0.0.1:8000/api/addToCart',
                data: {'prodID': productID},
                success: function(apiResponse) {
                    if (apiResponse.success) 
                    {
                        $('.cart-quantity').html(apiResponse.cartItems);
                        alert(apiResponse.message);
                    }
                    else
                    {
                        setCookie('errorMsg', apiResponse.message, 1);
                        window.location = '/login';
                    }
                }
            })
        }

        function emailCartData() {
            $('.w-commerce-commercecartcontainerwrapper').css('display', 'flex');
            $.ajax({
                type: 'GET',
                url: 'http://127.0.0.1:8000/api/getCart',
                success: function(apiResponse) {
                    $('.w-commerce-commercecartcontainerwrapper').css('display', 'none');
                    var emailMsg = 'Hi there,\n\nI\'ve added the following items to the cart. Please let me know anything else you need.\n\n'
                    apiResponse.productsList.forEach(function(product) {
                        emailMsg += 'Product Name: \t' + product.title + '\nQuantity: \t\t\t' + product.quantity + '\nPrice: \t\t\t$' + product.price + ' USD\n\n';
                    });
                    emailMsg += "=".repeat(50) + '\n\nSubtotal: \t\t$' + apiResponse.subTotal + ' USD\nTax: \t\t$' + apiResponse.tax + ' USD\nTotal: \t\t$' + apiResponse.totalAmt + ' USD\n\n';
                    emailMsg += 'Best,\n' + document.cookie.split('; ').find((cookie) => cookie.startsWith('userName')).split('=')[1].slice(1, -1);
                    window.location = 'mailto:?Subject=Grocery Shopping List&Body=' + encodeURIComponent(emailMsg);
                }
            })
        }

        function printDiv(divName) {
            var printContents = document.getElementById(divName).innerHTML;
            var originalContents = document.body.innerHTML;
            document.body.innerHTML = printContents;
            window.print();
            document.body.innerHTML = originalContents;
       }

        $(document).ready(function() {
            $.getJSON('http://ip-api.com/json', function(geoData) {
                $('#geoLocation').html('available in ' + geoData.city + ', ' + geoData.region);
            });

            $.getJSON('http://127.0.0.1:8000/api/getStoreStats', function(storeStats) {
                $('#productsAvailable').html(storeStats.productsAvailable);
                $('#categoriesAvailable').html(storeStats.categoriesAvailable);
                $('#avgReviews').html(storeStats.avgReviews);
                $('#prodRatings').html(storeStats.prodRatings);
            });

            if (document.cookie != '')
            {
                userName = document.cookie.split('; ').find((cookie) => cookie.startsWith('userName')).split('=')[1].slice(1, -1).split(' ')[0];
                $('#welcomeText').html('<span class="button-primary button-header-primary w-button">Hello ' + userName + '</span>');
    
                userName = document.cookie.split('; ').find((cookie) => cookie.startsWith('userName')).split('=')[1].slice(1, -1);
                $('#cartName').val(userName);

                $.ajax({
                    type: 'GET',
                    url: 'http://127.0.0.1:8000/api/getCartCount',
                    success: function(apiResponse) {
                        if (apiResponse.success) 
                            $('.cart-quantity').html(apiResponse.cartItems);
                    }
                })
            }

            const searchBtn = document.getElementById('micBtn');
            const searchInput = document.getElementById('searchProduct');

            if ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {
                const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();

                let recognitionTimeout;

                recognition.onresult = (event) => {
                    const query = event.results[0][0].transcript;
                    searchInput.value = query;
                    console.log('Search query:', query);
                    performVoiceSearch(query);
                };

                recognition.onerror = (event) => {
                    console.error('Speech recognition error:', event.error);
                };

                recognition.onnomatch = () => {
                    console.log('No speech recognized.');
                };

                searchBtn.addEventListener('click', () => {
                    recognition.start();
                });
            }
        });

        setTimeout(performSearch, 1000);
    </script>
</html>